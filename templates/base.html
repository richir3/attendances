<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Base template{% endblock %}</title>
    {% block css %}{% endblock %}
</head>
<body>
    <header>
        <h1>{% block header %}Base template{% endblock %}</h1>
        <nav>
            {% if user.is_authenticated %}
                <div>
                    <button id="logout">Logout</button>
                    <button id="home">Home</button>
                </div>
                <div>Welcome, {{ user.username }}!</div>
            {% endif %}
            
        </nav>
    </header>

    <main>
        {% block content %}
        <p>Welcome to My Django App!</p>
        {% endblock %}
    </main>
    
    {% block scripts %}
    {% endblock %}
    <script>
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== "") {
                const cookies = document.cookie.split("; ");
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.startsWith(name + "=")) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        
        {% if user.is_authenticated %}
        document.getElementById("logout").addEventListener("click", () => {
            fetch("{% url 'logout' %}", {
                method: "POST",
                headers: {
                    "X-CSRFToken": getCookie("csrftoken"),
                },
            }).then(() => {
                window.location.href = "{% url 'login' %}";
            });
        });
        document.getElementById("home").addEventListener("click", () => {
            window.location.href = "{% url 'home' %}";
            console.log("Home button clicked");
        });
        {% endif %}
        
    </script>
</body>
</html>
